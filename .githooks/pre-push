#!/bin/bash

echo "➡️ Obteniendo archivos PHP modificados..."

# Obtener archivos PHP agregados o modificados para el push
FILES=$(git diff --cached --name-only --diff-filter=ACM | grep '\.php$')

if [ -z "$FILES" ]; then
    echo "✅ No hay archivos PHP nuevos o modificados para validar."
    exit 0
fi

# Ejecutar script validador pasándole los archivos modificados
echo "➡️ Validando archivos modificados..."
php scripts/doc-validator.php $FILES
RESULT=$?

if [ $RESULT -ne 0 ]; then
    echo "❌ Errores de documentación detectados. Corrige antes de hacer push."
    exit 1
fi

echo "✅ Validación de documentación completada correctamente."
exit 0
